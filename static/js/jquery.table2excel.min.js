!function(o,c,r){function n(e,t){this.element=e,this.settings=o.extend({},a,t),this._defaults=a,this._name=l,this.init()}function x(e){return e.filename||"table2excel"}var l="table2excel",a={exclude:".noExl",name:"Table2Excel",filename:"table2excel",fileext:".xls",exclude_img:!0,exclude_links:!0,exclude_inputs:!0};n.prototype={init:function(){var i=this;i.template={head:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets>',sheet:{head:"<x:ExcelWorksheet><x:Name>",tail:"</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet>"},mid:"</x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body>",table:{head:"<table>",tail:"</table>"},foot:"</body></html>"},i.tableRows=[],o(i.element).each(function(e,t){var n,l,a="";o(t).find("tr").not(i.settings.exclude).each(function(e,t){a+="<tr>",o(t).find("td,th").not(i.settings.exclude).each(function(e,t){var n=o(this).attr("rowspan"),l=o(this).attr("colspan");0<o(t).find(i.settings.exclude).length?a+="<td> </td>":n&l?a+="<td>"+o(t).html()+"</td>":(a+="<td",0<n&&(a+=" rowspan='"+n+"' "),0<l&&(a+=" colspan='"+l+"' "),a+="/>"+o(t).html()+"</td>")}),a+="</tr>",console.log(a)}),i.settings.exclude_img&&(l=/(\s+alt\s*=\s*"([^"]*)"|\s+alt\s*=\s*'([^']*)')/i,a=a.replace(/<img[^>]*>/gi,function(e){return null!==(e=l.exec(e))&&2<=e.length?e[2]:""})),i.settings.exclude_links&&(a=a.replace(/<a[^>]*>|<\/a>/gi,"")),i.settings.exclude_inputs&&(n=/(\s+value\s*=\s*"([^"]*)"|\s+value\s*=\s*'([^']*)')/i,a=a.replace(/<input[^>]*>|<\/input>/gi,function(e){return null!==(e=n.exec(e))&&2<=e.length?e[2]:""})),i.tableRows.push(a)}),i.tableToExcel(i.tableRows,i.settings.name,i.settings.sheetName)},tableToExcel:function(e,t,n){var l,a,i=this,s="";if(i.format=function(e,n){return e.replace(/{(\w+)}/g,function(e,t){return n[t]})},i.ctx={worksheet:t||"Worksheet",table:e,sheetName:n=void 0===n?"Sheet":n},s=i.template.head,o.isArray(e))for(l in e)s+=i.template.sheet.head+n+l+i.template.sheet.tail;if(s+=i.template.mid,o.isArray(e))for(l in e)s+=i.template.table.head+"{table"+l+"}"+i.template.table.tail;for(l in s+=i.template.foot,e)i.ctx["table"+l]=e[l];return delete i.ctx.table,r.documentMode?"undefined"!=typeof Blob?(s=[s=i.format(s,i.ctx)],t=new Blob(s,{type:"text/html"}),c.navigator.msSaveBlob(t,x(i.settings))):(txtArea1.document.open("text/html","replace"),txtArea1.document.write(i.format(s,i.ctx)),txtArea1.document.close(),txtArea1.focus(),sa=txtArea1.document.execCommand("SaveAs",!0,x(i.settings))):(t=new Blob([i.format(s,i.ctx)],{type:"application/vnd.ms-excel"}),c.URL=c.URL||c.webkitURL,t=c.URL.createObjectURL(t),(a=r.createElement("a")).download=x(i.settings),a.href=t,r.body.appendChild(a),a.click(),r.body.removeChild(a)),!0}},o.fn[l]=function(e){var t=this;return t.each(function(){o.data(t,"plugin_"+l)||o.data(t,"plugin_"+l,new n(this,e))}),t}}(jQuery,window,document);